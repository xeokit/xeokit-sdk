<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>xeokit Examples</title>
    <link href='https://fonts.googleapis.com/css?family=Exo+2:400,800,900,700,600,500|Roboto:100,300,400,500,700,900' rel='stylesheet' type='text/css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
    

    <style>

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            font-size: 1rem;
            line-height: 1.50;
            color: #212529;
            background-color: #000000;
            text-decoration: none;
            word-spacing: normal;
            text-align: left;
            letter-spacing: 0;
            -webkit-font-smoothing: antialiased;
            overflow-y: hidden;
            overflow-x: hidden;
            margin: 0;
            width: 100%;
            height: 100%;
        }

        #index {
            position: absolute;
            height: 100%;
            background: #fdfdfd;
            overflow: auto;
            border-right: 2px solid #212529;
            padding: 20px;
            padding-bottom: 100px;
            user-select: none;
        }

        #index a {
            /*text-decoration: none;*/
        }

        #index h1 {
            margin-top: 0;
            margin-bottom: 0;
            font-size: 1.8rem;
            font-weight: normal;
            text-decoration: none !important;
        }

        #index h1 a {
            color: #212529;
        }

        #index h2 {
            font-size: 1.4rem;
            font-weight: normal;
            padding-top: 20px;
            padding-bottom: 10px;
            text-decoration: none;
        }

        #index .link {
            margin-left: 0 !important;
            padding-left: 0 !important;
            padding-top: 1px;
            text-decoration: none;
            font-weight: normal;
            background: #fdfdfd;
            cursor: pointer;
            line-height: 1.5em;
        }

        #index .selected {
            margin-left: -5px !important;
            padding-left: 5px !important;
            padding-top: 0;
            padding-bottom: 0;
            border: 1px solid #676767;
            background: #FFFF44;
        }


        #index .commentFirst {
            margin-left: 0 !important;
            padding-left: 0 !important;
            padding-top: 1px;
            text-decoration: none;
            font-weight: normal;
            font-style: italic;
            color: #8b8b8b;
            cursor: pointer;
            line-height: 1.5em;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        #index .comment {
            color: #8b8b8b;
            margin-left: 0 !important;
            padding-left: 0 !important;
            padding-top: 1px;
            text-decoration: none;
            font-weight: normal;
            font-style: italic;
            cursor: pointer;
            line-height: 1.5em;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        #index .link:hover {
            text-decoration: underline;
        }

        .content-container {
            position: absolute;
            z-index: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            margin: 0 auto;
            overflow: hidden;
            opacity: 1.0;
            pointer-events: all;
            transition: all 300ms ease-in-out;
            background: lightblue;
        }

        .content-overlay {
            position: absolute;
            z-index: 7;
            padding: 0;
            width: 100%;
            height: 100%;
            margin: 0 auto;
            overflow: hidden;
            opacity: 1.0;
            pointer-events: none;
            transition: all 300ms ease-in-out;
        }

        .slideout-sidebar {
            position: fixed;
            top: 0;
            left: -600px;
            z-index: 10;
            width: 560px;
            height: 100%;
            padding: 0;
            transition: all 300ms ease-in-out;
        }

        #index_toggle {
            display: none;
        }

        #index_toggle:hover {
            cursor: pointer;
        }

        .index-button {
            position: absolute;
            font-size: 18px;
            top: 15px;
            left: 20px;
            text-align: center;
            vertical-align: middle;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            z-index: 5;
            transition: all 300ms ease-in-out;
        }

        .index-button:hover {
            cursor: pointer;
            color: black;
        }

        .page-title {
            position: absolute;
            font-size: 1.6rem;
            top: 17px;
            left: 75px;
            text-align: left;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            z-index: 5;
            transition: all 300ms ease-in-out;
            max-width: calc(100% - 550px);
            pointer-events: none;
        }

        .viewSourceButton {
            position: absolute;
            left: 20px;
            bottom: 15px;
            z-index: 200;
            transition: all 300ms ease-in-out;
        }

        .viewSourceButton:hover {
            cursor: pointer;
            opacity: 1;
            color: black;
        }

        #index_toggle:checked ~ .slideout-sidebar {
            left: 0;
        }

        #index_toggle:checked + .index-button {
            left: 585px;
            color: white;
        }

        #index_toggle:checked ~ .page-title {
            left: 530px;
            color: white;
        }

        #index_toggle:checked ~ .viewSourceButton {
            left: 570px;
        }

        #index_toggle:checked ~ .content-container {
            opacity: 0.4;
            pointer-events: none;
        }

        #index_toggle:checked ~ .content-overlay {
            pointer-events: all;
        }

    </style>
</head>
<body>
<input id="index_toggle" type="checkbox"/>
<label class="index-button" for="index_toggle"><i class="fas fa-2x fa-bars"></i></label>
<div class="page-title" id="page-title"></div>
<div class="viewSourceButton" id="viewSourceButton"><i class="fas fa-2x fa-code"></i></div>
<div class="content-overlay" id="viewer-overlay"></div>
<iframe class="content-container" id="viewer" src="../default.html"></iframe>
<div class="slideout-sidebar">
    <div id="index"><h1><a href="http://xeokit.io">xeokit</a> / <a href="../">Examples</a> / Buildings</h1></div>
</div>
</body>
<script>

    const files = {

        "XKT": [

            "#XKT + VBOs",

            ["xkt_vbo_RACHouse", "IFC4 RAC model loaded from XKT into SceneModel"],
            ["xkt_vbo_IfcOpenHouse4", "IFC4 OpenHouse model loaded from XKT into SceneModel"],
            ["xkt_vbo_Schependomlaan", "IFC4 Schependomlaan model loaded from XKT into SceneModel"],
            ["xkt_vbo_Duplex", "IFC4 Duplex model loaded from XKT into SceneModel"],
            ["xkt_vbo_HolterTower", "IFC4 Holter Tower model loaded from XKT into SceneModel"],
            ["xkt_vbo_MAP", "IFC4 MAP model loaded from XKT into SceneModel"],
            ["xkt_vbo_RAC", "IFC4 RAC model loaded from XKT into SceneModel"],
            ["xkt_vbo_RME", "IFC4 RME model loaded from XKT into SceneModel"],
            ["xkt_vbo_WaterLock", "IFC4 WaterLock model loaded from XKT into SceneModel"],
            ["xkt_vbo_HousePlan", "House Plan model without textures loaded from XKT into SceneModel"],
            ["xkt_vbo_textures_HousePlan", "House Plan model with textures loaded from XKT into SceneModel"],
            ["xkt_vbo_federated_Clinic", "Viewing a federated BIM model loaded from XKT into SceneModels"],
            ["xkt_vbo_DemoProjekt", "Viewing a BIM model exported from ArchiCAD"],
            ["xkt_vbo_OTCConferenceCenter", "OTC Conference Center model, loaded from XKT into SceneModel"],
            ["xkt_vbo_includeIds", "Loading an XKT model with only selected elements with specific ids"],

            "#XKT + Data Textures",

            ["xkt_dtx_RACHouse", "IFC4 RAC model loaded from XKT into SceneModel"],
            ["xkt_dtx_IfcOpenHouse4", "IFC4 OpenHouse model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_Schependomlaan", "IFC4 Schependomlaan model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_HolterTower", "IFC4 Holter Tower model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_RAC", "IFC4 RAC model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_MAP", "IFC4 MAP model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_Store", "IFC4 Store model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_APHS", "APHS BIM model loaded from XKT into SceneModel (data textures enabled)"],
            ["xkt_dtx_WestRiverSideHospital", "Viewing seven IFC4 BIM models (data textures enabled)"],

            // ["BIMOffline_XKT_includeTypes", "Loading only IfcWalls from an IFC4 BIM model"],
            // ["BIMOffline_XKT_objectDefaults", "Viewing an IFC2x3 BIM model, providing custom colors for IFC types"],
            ["xkt_dtx_metadata_Schependomlaan", "Using IFC metadata to X-ray an IfcBuildingStorey"],
            ["xkt_dtx_metadata_moveStoreys", "Using IFC metadata to separate IfcBuildingStoreys"],
            // ["BIMOffline_XKT_authorMetadata", "Viewing an IFC4 BIM model with authoring data"],
            // ["BIMOffline_XKT_Duplex_originalIFCColors", "Viewing an IFC2x3 BIM model, with colors loaded from file"],
            ["xkt_dtx_DemoProjekt", "Viewing a BIM model exported from ArchiCAD (data textures enabled)"],
        
            "#XKT + IfcAxisLabels",

            ["xkt_grid_labels", "Viewing an XKT model containing a grid with labels"],
            ["xkt_model_labels", "Viewing an XKT model with a grid and some labels"],
        ],

        "XKT Multipart": [

            "#XKT + VBOs",

            ["xkt_manifest_KarhumakiBridge", "Loading a BIM model split into multiple XKT models"],
            ["xkt_manifest_KarhumakiBridge_inline", "Loading BIM from split XKT, manifest as parameter"],
            ["xkt_manifest_KarhumakiBridge_inline_urls", "Loading BIM from split XKT, manifest as parameter, files as URLs"],
            ["xkt_manifest_KarhumakiBridge_hotlink", "Loading BIM model from split XKT at xeokit.github.io/xeokit-model-conversion-tests"],
            ["xkt_manifest_Clinic", "Loading a federated BIM model split into multiple XKT models"],
            ["xkt_manifest_WestRiverSideHospital", "Loading a BIM model split into multiple XKT models"]
        ],

        "GLB": [

            "#Binary glTF + VBOs",

            ["glb_autoMetaModel_MAP", "IFC4 MAP model loaded from glTF into SceneModel using autoMetaModel option"],
            ["glb_HousePlan", "House plan model loaded from GLB into SceneModel using GLTFLoaderPlugin"],
            ["glb_VianneyHouse", "Vianney house model loaded from GLB into SceneModel using GLTFLoaderPlugin"]
        ],

        "dotbim": [

            "#dotbim",

            ["dotbim_BlenderHouse", "House model loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_MulticolorHouse", "House model with face_colors loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_Teapots", "10000+ teapots loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_House", "House model from IFC conversion loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_TestStructure", "Structural model from IFC conversion loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_SmallHouse", "House model with property sets, loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
            ["dotbim_TestFaceColors", "Test model with cubes with different face_colors loaded from .BIM into SceneModel using DotBIMLoaderPlugin"],
        ],
        
        "cxConverterIFC": [
            "#cxConverterIFC + VBOs",
            ["cxConverterIFC_vbo_Duplex", "IFC4 Duplex model loaded from IFC into SceneModel using CxConverterIFCPlugin"]
        ],

        "web-ifc": [

            "#web-ifc + VBOs",

            ["web-ifc_vbo_Duplex", "IFC4 Duplex model loaded from IFC into SceneModel using WebIFCLoaderPlugin"],
            ["web-ifc_vbo_ignoreMetadata", "IFC4 RAC model loaded from IFC into SceneModel using WebIFCLoaderPlugin, without metadata"],
            ["web-ifc_vbo_isolateStorey", "IFC4 Duplex model single storey loaded from IFC into SceneModel using WebIFCLoaderPlugin"],
            ["web-ifc_vbo_MAPGroundFloor", "IFC4 MAP model ground floor loaded from IFC into SceneModel using WebIFCLoaderPlugin"],

            "#web-ifc + DTX",

            ["web-ifc_dtx_Duplex", "IFC4 Duplex model loaded from IFC into SceneModel using WebIFCLoaderPlugin (data textures enabled)"],
            ["web-ifc_dtx_MAPGroundFloor", "IFC4 MAP model ground floor loaded from IFC into SceneModel using WebIFCLoaderPlugin (data textures enabled)"]
        ],

        "glTF": [

            "#glTF + VBOs",

            ["glTF_VianneyHouse", "Vianney house model loaded from glTF into SceneModel using GLTFLoaderPlugin"],
            ["glTF_Duplex_transform", "IFC4 Duplex house model loaded from glTF into SceneModel using GLTFLoaderPlugin"],
            ["glTF_embedded_MAP", "IFC4 MAP model loaded from glTF into SceneModel using GLTFLoaderPlugin"],
            ["glTF_Schependomlaan", "IFC2x3 Schependomlaan house model loaded from glTF into SceneModel using GLTFLoaderPlugin"],
            ["glTF_DuckQuantized", "Duck model loaded from glTF with quantized vertex attributes"]
        ],

        "Positioning Models": [

            "#Positioning models geographically",

            ["positioning_cartesianCoordinates", "Loading IFC with WebIFCLoaderPlugin, positioning the model at distant Cartesian coordinates"],
            ["positioning_geodesicCoordinates", "Loading IFC with WebIFCLoaderPlugin, positioning the model with geodesic coordinates"]
        ],

        "Google Street Maps": [

            "#Viewing models from Google Street Maps",

            ["glb_GoogleStreetMaps_Beograd01", "Viewing a glTF model exported from google Street Maps"],
            ["glb_GoogleStreetMaps_BeogradCenter", "Viewing a GLB model exported from google Street Maps"],
            ["glb_GoogleStreetMaps_DveKule", "Viewing a GLB model exported from google Street Maps"]
        ],

        "Misc": [
            "# Simulate single-precision rendering jitter",

            ["jitter_singlePrecision_MAP", "Demonstrates rounding jitter"],

            "# Configuring custom buffer sizes to experiment with loading stability",

            ["xkt_dtx_maxDataTextureHeight", "Configuring max data texture size"],
            ["xkt_vbo_maxGeometryBatchSize", "Configuring max VBO geometry batch size"]
        ]

    };

    const list = document.getElementById('index');
    const viewer = document.getElementById('viewer');
    const viewerOverlay = document.getElementById('viewer-overlay');

    const container = document.createElement('div');
    list.appendChild(container);

    const viewSourceButton = document.getElementById('viewSourceButton');
    viewSourceButton.addEventListener('click', function (event) {
        window.open('https://github.com/xeokit/xeokit-sdk/blob/master/examples/buildings/' + selected + '.html');
    }, false);

    const indexToggle = document.getElementById("index_toggle");
    const pageTitle = document.getElementById('page-title');

    viewerOverlay.addEventListener('click', function (event) {
        indexToggle.checked = false;
    }, false);

    // indexToggle.addEventListener('click', function (event) {
    //     viewer.src="default.html";
    // }, false);

    const sectionDivs = {};
    const divs = {};
    const fileDescriptions = {};
    let selected = null;
    let index = 1;
    var indexStr;

    // Index

    let div = document.createElement('h2');
    div.textContent = "Index";

    container.appendChild(div);
    container.appendChild(document.createElement('hr'));

    const sectionNames = Object.keys(files);
    // sectionNames.sort((a, b) => {
    //     if (a < b) {
    //         return -1;
    //     }
    //     if (a > b) {
    //         return 1;
    //     }
    //     return 0;
    // });

    for (let i = 0, len = sectionNames.length; i < len; i++) {
        const sectionName = sectionNames[i];
        const sectionFiles = files[sectionName];
        var sectionDiv = document.createElement('div');
        sectionDiv.className = 'link';
        indexStr = "" + index++ + ".";
        for (let i = indexStr.length, len = 5; i < len; i++) {
            indexStr += ".";
        }
        sectionDiv.textContent = indexStr + sectionName;
        sectionDiv.addEventListener('click', (function () {
            const _sectionName = sectionName;
            return function () {
                sectionDivs[_sectionName].scrollIntoView();
            }
        })());
        container.appendChild(sectionDiv);
    }

    container.appendChild(document.createElement('hr'));

    _index = 1;

    let clickedFile = null;

    for (let i = 0, len = sectionNames.length; i < len; i++) {
        const sectionName = sectionNames[i];
        const sectionFiles = files[sectionName];
        const sectionDiv = document.createElement('h2');
        sectionDiv.textContent = _index++ + ". " + sectionName;
        container.appendChild(sectionDiv);
        sectionDivs[sectionName] = sectionDiv;
        container.appendChild(document.createElement('hr'));

        for (let i = 0; i < sectionFiles.length; i++) {

            let sectionFile = sectionFiles[i];
            let fileName;
            let fileDesc;

            if (!isString(sectionFile)) {
                fileName = sectionFile[0];
                fileDesc = sectionFile[1];
            } else {
                fileName = sectionFile;
                fileDesc = sectionFile;
            }

            if (fileDesc.charAt(0) === "#") {
                const commentDiv = document.createElement('div');
                commentDiv.textContent = "// " + fileDesc.substring(1);
                commentDiv.className = (i === 0 ? 'commentFirst' : 'comment');
                container.appendChild(commentDiv);
                continue;
            }

            const fileNameComponents = fileName.split('_');
            //    fileNameComponents.shift();
            const fileNamePath = fileNameComponents.join(' / ');
            const fileNameDiv = document.createElement('div');
            fileNameDiv.className = 'link';
            fileNameDiv.textContent = fileNamePath; // expandCamel(name);
            fileNameDiv.addEventListener('click', (function () {
                const _file = fileName;
                return function () {
                    clickedFile = _file;
                    window.location.hash = "#" + _file;
                    viewer.src = "";
                }
            })());
            container.appendChild(fileNameDiv);
            divs[fileName] = fileNameDiv;
            fileDescriptions[fileName] = fileDesc;
        }
    }

    const paddingDiv = document.createElement('div');
    paddingDiv.style["height"] = "50px";
    container.appendChild(paddingDiv);

    function expandCamel(str) {
        return str.replace(/([A-Z])/g, function ($1) {
            return " " + $1.toLowerCase();
        });
    }

    if (window.location.hash !== '') {
        load(window.location.hash.substring(1));
    } else {
        indexToggle.checked = true;
    }

    var hash = window.location.hash;

    window.setInterval(function () {
        if (window.location.hash !== hash || viewer.src === "") {
            setTimeout(() => {
                load(window.location.hash.substring(1));
                hash = window.location.hash;
            }, 300)

            indexToggle.checked = false;
        }
    }, 70);

    function scrollIntoView(div) {
        document.getElementById("index").scrollTop = documentOffsetTop(div) - (window.innerHeight / 6);
    }

    function documentOffsetTop(div) {
        return div.offsetTop + (div.offsetParent ? documentOffsetTop(div.offsetParent) : 0);
    }

    function load(file) {

        pageTitle.innerText = fileDescriptions[file] || "Example not found - perhaps renamed?";

        if (file.indexOf(".html", file.length - 5) !== -1) {
            window.location = "./" + file + ".html";
            return;
        }

        if (selected !== null) divs[selected].className = 'link';
        divs[file].className = 'link selected';
        window.location.hash = file;
        viewer.src = file + '.html';
        viewer.focus();
        viewSourceButton.style.display = '';
        selected = file;
        if (clickedFile !== file) {
            scrollIntoView(divs[file]);
        }
        clickedFile = null;
    }

    function isString(value) {
        return (typeof value === 'string' || value instanceof String);
    }

</script>
</html>
